<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>
      Weld: Documentation
    </title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css" rel="stylesheet" type="text/css">
    <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <!-- /If IE7 for font-awesome -->
    <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome-ie7.min.css" rel="stylesheet" type="text/css">
    <link href="http://weld.github.io/stylesheets/styles.css" rel="stylesheet" type="text/css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span2" style="min-height:1px;">
          <ul class="nav nav-tabs nav-stacked span2 visible-desktop" id="main_nav">
            <li>
              <a href="/">
                <i class="icon-home"></i>
                Home
              </a>
            </li>
            <li>
              <a href="/download">
                <i class="icon-download"></i>
                Download
              </a>
            </li>
            <li>
              <a href="/news">
                <i class="icon-edit"></i>
                News
              </a>
            </li>
            <li>
              <a href="https://issues.jboss.org/browse/WELD#selectedTab=com.atlassian.jira.plugin.system.project%3Aroadmap-panel">
                <i class="icon-road"></i>
                Road map
              </a>
            </li>
            <li>
              <a href="/documentation">
                <i class="icon-book"></i>
                Docs &amp; FAQ
              </a>
            </li>
            <li>
              <a href="/community">
                <i class="icon-group"></i>
                Community
              </a>
            </li>
            <li>
              <a href="http://github.com/weld">
                <i class="icon-github-alt"></i>
                Source code
              </a>
            </li>
            <li>
              <a href="https://issues.jboss.org/browse/WELD#selectedTab=com.atlassian.jira.plugin.system.project%3Asummary-panel">
                <i class="icon-tasks"></i>
                Bug tracker
              </a>
            </li>
          </ul>
          <a class="hidden-desktop" href="#" id="toggle_menu">
            <i class="icon-exchange"></i>
          </a>
          <ul class="nav nav-tabs nav-stacked span2 hide hidden-desktop" id="mobile_menu">
            <li>
              <a href="/">
                <i class="icon-home"></i>
                Home
              </a>
            </li>
            <li>
              <a href="/download">
                <i class="icon-download"></i>
                News
              </a>
            </li>
            <li>
              <a href="/roadmap">
                <i class="icon-road"></i>
                Road map
              </a>
            </li>
            <li>
              <a href="/documentation">
                <i class="icon-book"></i>
                Documentation
              </a>
            </li>
            <li>
              <a href="/community">
                <i class="icon-group"></i>
                Community
              </a>
            </li>
            <li>
              <a href="http://github.com/weld">
                <i class="icon-github-alt"></i>
                Source code
              </a>
            </li>
            <li>
              <a href="https://jira.jboss.org/jira/browse/WELD">
                <i class="icon-tasks"></i>
                Bug tracker
              </a>
            </li>
            <li>
              <a href="/governance"></a>
              <i class="icon-edit">
                Governance
              </i>
            </li>
          </ul>
        </div>
        <div class="span10">
          <div class="row">
            <div class="span4">
              <img alt="Weld Logo" class="weld-home-logo" src="/images/weld_logo_450x.png">
            </div>
            <div class="span8">
              <img alt="CDI tagcloud" class="cdi-background" src="/images/CDIbackground.png">
            </div>
          </div>
          <div class="row-fluid">
            <div class="span10">
              <h2>Documentation</h2>
              <p>Weld reference documentation can be viewed online or downloaded as a PDF.</p>
              <ul>
                <li>
                  <a href="http://docs.jboss.org/weld/reference/latest/en-US/html/">HTML</a>
                </li>
                <li>
                  <a href="http://docs.jboss.org/weld/reference/latest/en-US/html_single/">HTML (Single page)</a>
                </li>
                <li>
                  <a href="http://docs.jboss.org/weld/reference/latest/en-US/pdf/weld-reference.pdf">PDF</a>
                </li>
              </ul>
              <h2>FAQ</h2>
              <ul>
                <li>
                  <a href="#0">
                    If I create a thread in my CDI bean, how will Weld react?
                  </a>
                </li>
                <li>
                  <a href="#1">
                    Why does Weld leave some proxy class definitions lying around when I undeploy my application? How can I prevent this?
                  </a>
                </li>
                <li>
                  <a href="#2">
                    Some of my beans aren&#8217;t deployed and I can&#8217;t see why?
                  </a>
                </li>
                <li>
                  <a href="#3">
                    Why does Weld set character encoding of an HTTP request/response body to ISO-8859-1?
                  </a>
                </li>
              </ul>
              <hr>
              <div id="0">
                <h4>
                  If I create a thread in my CDI bean, how will Weld react?
                </h4>
                <div id="preamble">
                <div class="sectionbody">
                <div class="paragraph">
                <p>Weld assumes requests are single threaded, and uses thread locals to isolate requests. This means that if user created threads are used then built in implementation of the session scope, the request scope and the conversation scope, will become dissociated, and you will find they are no longer active in the new thread, nor able to access their contextual data. The Weld <a href="http://docs.jboss.org/weld/reference/latest/en-US/html/contexts.html">reference guide</a> contains information on how to associate a request to a context and activate it. Doing this in your new thread will cause the contexts to be active, and contain the same contextual data.</p>
                </div>
                <div class="paragraph">
                <p>The dependent context and the application context will work as usual in any user created thread.</p>
                </div>
                
                </div>
                </div>
              </div>
              <div id="1">
                <h4>
                  Why does Weld leave some proxy class definitions lying around when I undeploy my application? How can I prevent this?
                </h4>
                <div id="preamble">
                <div class="sectionbody">
                <div class="paragraph">
                <p>When a Weld-enabled application is deployed on an application server or a web server, proxy classes for beans implementing interfaces or extending classes contained in common libraries are loaded in the class loader (CL) for that library, not the thread context class loader (TCCL). This means that these proxy classes will not be removed from the server when the application is undeployed.</p>
                </div>
                <div class="paragraph">
                <p>The reason for this approach is to support the use of package scoped classes and members of classes which need to be proxied as beans. Thus the TCCL is not used for the proxy classes generated by Weld.</p>
                </div>
                <div class="paragraph">
                <p>One way to prevent this problem is to simply deploy those libraries with your application. In this scenario, those classes are loaded in a CL associated with the application and will thus be removed when the application is undeployed.</p>
                </div>
                
                </div>
                </div>
              </div>
              <div id="2">
                <h4>
                  Some of my beans aren&#8217;t deployed and I can&#8217;t see why?
                </h4>
                <div id="preamble">
                <div class="sectionbody">
                <div class="paragraph">
                <p>Weld will not create beans if it can&#8217;t load the class, or some class dependency. If that happens, you&#8217;ll see a note in the server log.</p>
                </div>
                <div class="listingblock">
                
                <div class="content monospaced">
                <pre class="highlight"><code>WELD-000119: Not generating any bean definitions from org.jboss.weld.tests.beanDeployment.noclassdeffound.Bar because of underlying class loading error</code></pre>
                </div>
                </div>
                <div class="paragraph">
                <p>You can view more details by increasing the log level of the application server to DEBUG.</p>
                </div>
                
                </div>
                </div>
              </div>
              <div id="3">
                <h4>
                  Why does Weld set character encoding of an HTTP request/response body to ISO-8859-1?
                </h4>
                <div id="preamble">
                <div class="sectionbody">
                <div class="paragraph">
                <p>An application may set character encoding of a request by calling the <a href="http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#setCharacterEncoding(java.lang.String)">ServletRequest.setCharacterEncoding()</a> method. This method has a limitation: it has to be called before the request parameters or request body are read, otherwise the method call has no effect.</p>
                </div>
                <div class="paragraph">
                <p>In order to properly activate the conversation context, Weld reads the <em>cid</em> request parameter in the beginning of request processing. As a side-effect, this makes it impossible to change the character encoding later in the request processing (since request parameters have been read already). As a result, an application servlet or filter which that tries to set character encoding will not work since it does that too late.</p>
                </div>
                <div class="paragraph">
                <p>A workaround is to have the application encoding-setting filter to be called before Weld tries to read the "cid" parameter in the ConversationFilter. This can be done by mapping the custom filter <em>before</em> Weld&#8217;s ConversationFilter in web.xml</p>
                </div>
                <div class="listingblock">
                
                <div class="content monospaced">
                <pre class="highlight"><code class="xml language-xml">&lt;web-app xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&#x000A;    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" version="3.0"&gt;&#x000A;    &lt;filter&gt;&#x000A;        &lt;filter-name&gt;SetCharacterEncoding&lt;/filter-name&gt;&#x000A;        &lt;filter-class&gt;org.apache.catalina.filters.SetCharacterEncodingFilter&lt;/filter-class&gt;&#x000A;        &lt;init-param&gt;&#x000A;            &lt;param-name&gt;encoding&lt;/param-name&gt;&#x000A;            &lt;param-value&gt;UTF-8&lt;/param-value&gt;&#x000A;        &lt;/init-param&gt;&#x000A;        &lt;init-param&gt;&#x000A;            &lt;param-name&gt;ignore&lt;/param-name&gt;&#x000A;            &lt;param-value&gt;false&lt;/param-value&gt;&#x000A;        &lt;/init-param&gt;&#x000A;    &lt;/filter&gt;&#x000A;    &lt;filter-mapping&gt;&#x000A;        &lt;filter-name&gt;SetCharacterEncoding&lt;/filter-name&gt;&#x000A;        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;&#x000A;    &lt;/filter-mapping&gt;&#x000A;    &lt;filter-mapping&gt;&#x000A;        &lt;filter-name&gt;Conversation&lt;/filter-name&gt;&#x000A;        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;&#x000A;    &lt;/filter-mapping&gt;&#x000A;&lt;/web-app&gt;</code></pre>
                </div>
                </div>
                
                </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <footer>
        <div class="row">
          <p>
            Copyright &copy; 2013,
            <a href="http://redhat.com">
              Red Hat, Inc.
            </a>
            Weld is licensed under the
            <a href="http://www.apache.org/licenses/LICENSE-2.0.html">
              Apache License, Version 2.0
            </a>
          </p>
        </div>
      </footer>
    </div>
  </body>
  <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js" type="text/javascript"></script>
  <script>
    $(document).ready(function() {
      $('#toggle_menu').click(function(){
        $("#mobile_menu").toggle();
      });
    });
  </script>
</html>
